---
alwaysApply: true
---

## Feature-first flow: spec before code

**CRITICAL**: For Cliplin to work correctly, **the feature file is always the source of truth**. On any user change or request you MUST follow this order:

### 1. Consider the feature spec first

- **Before** modifying code, rules, ADRs, or any other file, ask: does this change or request require an update to a feature spec?
- If **yes** or **unclear**: **suggest** updating (or creating) the relevant `.feature` file in `docs/features/` first. Propose the spec changes and get user agreement if needed; then update the feature file **before** touching any other file.
- If **no** (e.g. pure refactor that does not change behavior, or task explicitly outside feature scope): you may proceed without changing a feature file, but any new or changed behavior must still be traceable to a spec.

### 2. Then implement to fulfill the spec

- **After** the feature spec is correct (updated or confirmed), perform refactors or write new code **only to satisfy the specs**. The spec drives what is built; code does not drive the spec.
- If no feature existed for the scope: creating/updating the `.feature` file was the first step; implementation follows from it.

### Summary

- **Spec first, then code.** Never change code first and leave the feature file out of date or missing.
- **Suggest feature spec changes first** whenever the user's request implies new or changed behavior that should be specified.
- Every change must be traceable to a specification; the feature file is the primary source of truth for *what* the system does.

See also: `docs/business/framework.md` (section "Feature-first flow"), `docs/adrs/000-cliplin-framework.md` ("Operational flow: feature-first").
