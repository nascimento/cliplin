ts4: "1.0"
id: "ai-host-integration"
title: "AI Host Integration (Cursor, Claude Desktop)"
summary: "Cross-host rules: same MCP command, config generator sync, and checklist. Host-specific specs live in dedicated TS4s (cursor-integration, claude-desktop-integration)."

rules:
  - |
    Supported AI hosts and host-specific specs:
    - **Cursor**: config `.cursor/mcp.json`; rules `.cursor/rules/*.mdc`. Quirks and paths: docs/ts4/cursor-integration.ts4
    - **Claude Desktop**: config `.mcp.json` at project root; rules `.claude/rules/`; Skills support. Quirks and paths: docs/ts4/claude-desktop-integration.ts4
    - Other MCP-compatible hosts may be added later; each gets its own config generator and, if needed, a dedicated TS4 (e.g. docs/ts4/<host>-integration.ts4)
  - |
    MCP command must be consistent across hosts (MUST):
    - The command used to start the Cliplin MCP server MUST be the same for all supported hosts: use `uv run cliplin mcp` so the host runs the project's cliplin (with instructions); do not use bare `cliplin mcp` in templates, as it may resolve to a global install and cause "No server info found" or wrong version
    - In code: `create_cursor_mcp_config` and `create_claude_desktop_mcp_config` in `src/cliplin/utils/templates.py` MUST set the same command and args: `"command": "uv", "args": ["run", "cliplin", "mcp"]`
  - |
    When changing templates or MCP-related commands (MUST):
    - When modifying MCP server startup (command, args, env), init templates that write MCP config, or CLI behavior that affects how AI hosts run Cliplin, you MUST update **all** supported host config generators in the same change
    - Update both `create_cursor_mcp_config` and `create_claude_desktop_mcp_config` together; do not change only one
    - Use the same command pattern and args for Cursor and Claude Desktop unless a host-specific quirk is documented in the host's TS4
    - If adding a new host (e.g. another IDE or MCP client), add its config generator in templates.py, use the same command pattern unless the host requires otherwise, and add a dedicated TS4 (e.g. docs/ts4/<host>-integration.ts4) or document in docs/business/framework.md
  - |
    Checklist before merging changes to templates or MCP command:
    - [ ] create_cursor_mcp_config and create_claude_desktop_mcp_config both use the same command/args
    - [ ] Command is `uv run cliplin mcp` (or documented exception)
    - [ ] Any new host has its config generator and is listed in this TS4 (and has a host-specific TS4 if needed)

code_refs:
  - "src/cliplin/utils/templates.py"
  - "docs/adrs/004-mcp-server-instructions.md"
  - "docs/ts4/system-modules.ts4"
  - "docs/ts4/cursor-integration.ts4"
  - "docs/ts4/claude-desktop-integration.ts4"
  - "docs/business/framework.md"
